[2025-10-05 08:17:12,379][root][INFO] - Configuration: experiment:
  data_path: ../data
  checkpoint_dir: ../checkpoints
  models:
  - 'inf'
  row_fraction: 1.0
  num_targets: 424
  filter_features: false
  optuna:
    direction: minimize
    n_trials: 2
    n_jobs: 2
model:
  model_type: default
  model_class: default
  trainer_class: default
  params:
    input_size: 1672
    output_size: 424
    input_len: 64
    output_len: 5
    batch_size: 16
    hidden_size: 128
    num_layers: 2
    dropout: 0.1
    epochs: 10
    patience: 5
    channels: 64
    blocks: 3
    kernel_size: 5
    num_conv_layers: 2
    tcn_kernel: 3
    decom_kernel_size: 25
    top_k_modes: 5
    nhead: 8
    dim_feedforward: 512
    weight_decay: 0.001
    scheduler_patience: 5
    scheduler_factor: 0.5
    clip_grad_norm: 1.0
    partially_finite_target: false
  lr: 0.001
  optimizer: AdamW
  lr_policy: constant

[2025-10-05 08:17:12,380][root][INFO] - Set random seed to 42 for reproducibility.
[2025-10-05 08:17:12,380][root][INFO] - CUDA version: 12.1
[2025-10-05 08:17:12,416][root][INFO] - Device count: 1
[2025-10-05 08:17:12,417][root][INFO] - Device name: NVIDIA GeForce RTX 4060 Laptop GPU
[2025-10-05 08:17:12,517][root][INFO] - Loading train.csv from ../data/train.csv
[2025-10-05 08:17:12,594][root][INFO] - Loading train_labels.csv from ../data/train_labels.csv
[2025-10-05 08:17:12,696][root][INFO] - Loading target_pairs.csv from ../data/target_pairs.csv
[2025-10-05 08:17:12,840][root][INFO] - X_full NaNs after imputation: 0
[2025-10-05 08:17:12,840][root][INFO] - Y_full NaNs before imputation: 0
[2025-10-05 08:17:12,841][root][INFO] - Y_full NaNs after imputation: 0
[2025-10-05 08:17:12,841][root][INFO] - X_full feature count: 1671
[2025-10-05 08:17:12,849][root][INFO] - Data loaded: X_full_np shape=(1917, 1671), Y_full_np shape=(1917, 424)
[2025-10-05 08:17:12,849][root][INFO] - Raw data shapes: X=(1917, 1671), Y=(1917, 424)
[2025-10-05 08:17:12,849][root][INFO] - Sample batch shapes: X=(64, 1671), Y=(64, 424)
[2025-10-05 08:17:13,378][root][INFO] - Trial 16 started with params: {'input_size': 1671, 'output_size': 424, 'output_len': 5, 'input_len': 112, 'label_len': 64, 'hidden_size': 512, 'num_layers': 4, 'd_layers': 1, 'nhead': 8, 'dim_feedforward': 1024, 'dropout': 0.3, 'batch_size': 16, 'attn': 'prob', 'distil': True}, lr=1.0411160213149492e-05, optimizer=AdamW, lr_policy=clr
[2025-10-05 08:17:13,659][root][INFO] - Performed memory cleaning.
[2025-10-05 08:17:13,693][root][INFO] - Trial 17 started with params: {'input_size': 1671, 'output_size': 424, 'output_len': 5, 'input_len': 112, 'label_len': 64, 'hidden_size': 512, 'num_layers': 4, 'd_layers': 1, 'nhead': 4, 'dim_feedforward': 1024, 'dropout': 0.3, 'batch_size': 16, 'attn': 'prob', 'distil': True}, lr=1.313030809991738e-05, optimizer=AdamW, lr_policy=clr
[2025-10-05 08:17:13,956][root][INFO] - GPU Memory: 1.06 GB used out of 8.00 GB
[2025-10-05 08:17:13,956][root][INFO] - Performed memory cleaning.
[2025-10-05 08:17:13,957][root][INFO] - GPU Memory: 1.06 GB used out of 8.00 GB
[2025-10-05 08:17:13,961][root][INFO] - Trial 16: X_raw shape=(1917, 1671), Y_raw shape=(1917, 424), NaNs X=0, Y=0
[2025-10-05 08:17:13,961][root][INFO] - Trial 17: X_raw shape=(1917, 1671), Y_raw shape=(1917, 424), NaNs X=0, Y=0
[2025-10-05 08:17:13,961][root][INFO] - InTrainer initialized with model_kwargs: {'input_size': 1671, 'output_size': 424, 'input_len': 112, 'label_len': 64, 'output_len': 5, 'hidden_size': 512, 'nhead': 8, 'num_layers': 4, 'd_layers': 1, 'd_ff': 512, 'dropout': 0.3, 'attn': 'prob', 'distil': True}
[2025-10-05 08:17:13,961][root][INFO] - InTrainer initialized with model_kwargs: {'input_size': 1671, 'output_size': 424, 'input_len': 112, 'label_len': 64, 'output_len': 5, 'hidden_size': 512, 'nhead': 4, 'num_layers': 4, 'd_layers': 1, 'd_ff': 512, 'dropout': 0.3, 'attn': 'prob', 'distil': True}
[2025-10-05 08:17:14,281][root][INFO] - Trainer initialized with device=cpu
[2025-10-05 08:17:14,281][root][INFO] - Building Informer datasets with input_len=112, output_len=5, label_len=64, use_time_feats=True
[2025-10-05 08:17:14,285][root][INFO] - Trainer initialized with device=cpu
[2025-10-05 08:17:14,286][root][INFO] - Building Informer datasets with input_len=112, output_len=5, label_len=64, use_time_feats=True
[2025-10-05 08:17:15,029][root][INFO] - WindowDataset created: Xw shape=(1801, 112, 1671), Yw shape=(1801, 5, 424), invalid_windows: 0
[2025-10-05 08:17:15,035][root][INFO] - WindowDataset created: Xw shape=(1801, 112, 1671), Yw shape=(1801, 5, 424), invalid_windows: 0
[2025-10-05 08:17:22,656][root][INFO] - InformerWindowDataset created: Xw shape=(1801, 112, 1671), x_dec shape=(1801, 69, 424), Yw shape=(1801, 5, 424), mark_enc shape=(1801, 112, 512), invalid_windows=0
[2025-10-05 08:17:22,804][root][INFO] - Informer dataset created: X_enc shape=(1801, 112, 1671), x_dec shape=(1801, 69, 424), Y shape=(1801, 5, 424), mark_enc shape=(1801, 112, 512)
[2025-10-05 08:17:22,809][root][INFO] - InformerWindowDataset created: Xw shape=(1801, 112, 1671), x_dec shape=(1801, 69, 424), Yw shape=(1801, 5, 424), mark_enc shape=(1801, 112, 512), invalid_windows=0
[2025-10-05 08:17:22,814][root][INFO] - Informer dataset created: X_enc shape=(1801, 112, 1671), x_dec shape=(1801, 69, 424), Y shape=(1801, 5, 424), mark_enc shape=(1801, 112, 512)
[2025-10-05 08:17:23,586][root][INFO] - Informer DataLoaders created: train=1351, val=270, test=180
[2025-10-05 08:17:23,610][root][INFO] - Informer DataLoaders created: train=1351, val=270, test=180
[2025-10-05 08:17:23,869][root][ERROR] - Trial 16 failed: pred torch.Size([80, 5, 424]) vs y torch.Size([16, 5, 424])
Traceback (most recent call last):
  File "/root/vscode/portfolio/mitsui_2025/src/study.py", line 206, in objective_informer
    val_loss = trainer.train(X=X_raw, Y=Y_raw, train_loader=None, val_loader=None)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vscode/portfolio/mitsui_2025/src/trainer.py", line 719, in train
    assert y.shape == (B, T, C), f"pred {pred.shape} vs y {y.shape}"
           ^^^^^^^^^^^^^^^^^^^^
AssertionError: pred torch.Size([80, 5, 424]) vs y torch.Size([16, 5, 424])

[2025-10-05 08:17:24,200][root][INFO] - GPU Memory: 1.06 GB used out of 8.00 GB
[2025-10-05 08:17:24,201][root][ERROR] - Trial 17 failed: pred torch.Size([80, 5, 424]) vs y torch.Size([16, 5, 424])
Traceback (most recent call last):
  File "/root/vscode/portfolio/mitsui_2025/src/study.py", line 206, in objective_informer
    val_loss = trainer.train(X=X_raw, Y=Y_raw, train_loader=None, val_loader=None)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/vscode/portfolio/mitsui_2025/src/trainer.py", line 719, in train
    assert y.shape == (B, T, C), f"pred {pred.shape} vs y {y.shape}"
           ^^^^^^^^^^^^^^^^^^^^
AssertionError: pred torch.Size([80, 5, 424]) vs y torch.Size([16, 5, 424])

[2025-10-05 08:17:24,485][root][INFO] - Performed memory cleaning.
[2025-10-05 08:17:24,778][root][INFO] - GPU Memory: 1.06 GB used out of 8.00 GB
[2025-10-05 08:17:25,058][root][INFO] - Performed memory cleaning.
[2025-10-05 08:17:25,105][root][WARNING] - No completed trials for INF. All trials were pruned or failed. Trials: 18
[2025-10-05 08:17:25,108][root][INFO] - Trial states: [2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2]
